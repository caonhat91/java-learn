### **NgÃ y 5-6-7: SQL CÆ¡ Báº£n vá»›i H2DB**

---

### **I. Tá»•ng Quan Vá» SQL**

SQL (Structured Query Language) lÃ  ngÃ´n ngá»¯ tiÃªu chuáº©n Ä‘á»ƒ lÃ m viá»‡c vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡. SQL bao gá»“m cÃ¡c cÃ¢u lá»‡nh Ä‘á»ƒ truy váº¥n, chÃ¨n, sá»­a Ä‘á»•i, vÃ  xÃ³a dá»¯ liá»‡u, cÅ©ng nhÆ° Ä‘á»ƒ quáº£n lÃ½ cáº¥u trÃºc dá»¯ liá»‡u.

---

### **II. LÃ m Viá»‡c Vá»›i H2 Database**

H2 lÃ  má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ nháº¹, Ä‘Æ°á»£c viáº¿t hoÃ n toÃ n báº±ng Java, thÆ°á»ng Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thá»­ nghiá»‡m vÃ  phÃ¡t triá»ƒn vÃ¬ nÃ³ khÃ´ng yÃªu cáº§u cÃ i Ä‘áº·t phá»©c táº¡p.

- **Æ¯u Ä‘iá»ƒm:**
  - Nháº¹ vÃ  nhanh.
  - Há»— trá»£ cháº¿ Ä‘á»™ in-memory (dá»¯ liá»‡u khÃ´ng lÆ°u trÃªn Ä‘Ä©a).
  - TÆ°Æ¡ng thÃ­ch tá»‘t vá»›i Spring Boot.

---

### **III. CÃ i Äáº·t vÃ  Káº¿t Ná»‘i H2 vá»›i Spring Boot**

#### **1. Cáº¥u hÃ¬nh `application.yml`**
```yaml
spring:
  datasource:
    url: jdbc:h2:mem:testdb
    driver-class-name: org.h2.Driver
    username: sa
    password:
  h2:
    console:
      enabled: true
```

#### **2. Truy cáº­p H2 Console**
- Khi cháº¡y á»©ng dá»¥ng Spring Boot, báº¡n cÃ³ thá»ƒ truy cáº­p H2 Console táº¡i: `http://localhost:8080/h2-console`.
- Nháº­p thÃ´ng tin káº¿t ná»‘i:
  - **JDBC URL:** `jdbc:h2:mem:testdb`
  - **User Name:** `sa`
  - **Password:** *(Ä‘á»ƒ trá»‘ng)*.

---

### **IV. CÃ¡c CÃ¢u Lá»‡nh SQL CÆ¡ Báº£n**

#### **1. Táº¡o Báº£ng (`CREATE TABLE`)**
```sql
CREATE TABLE employees (
    id INT PRIMARY KEY,
    name VARCHAR(50),
    position VARCHAR(50),
    salary DECIMAL(10, 2),
    department_id INT
);
```

#### **2. ThÃªm Dá»¯ Liá»‡u (`INSERT INTO`)**
```sql
INSERT INTO employees (id, name, position, salary, department_id) 
VALUES 
(1, 'Alice', 'Manager', 80000, 1),
(2, 'Bob', 'Developer', 60000, 1),
(3, 'Charlie', 'Analyst', 50000, 2);
```

#### **3. Xem Dá»¯ Liá»‡u (`SELECT`)**
```sql
SELECT * FROM employees;
```

#### **4. Sá»­a Dá»¯ Liá»‡u (`UPDATE`)**
```sql
UPDATE employees
SET salary = 70000
WHERE name = 'Bob';
```

#### **5. XÃ³a Dá»¯ Liá»‡u (`DELETE`)**
```sql
DELETE FROM employees
WHERE id = 3;
```

---

### **V. CÃ¡c PhÃ©p JOIN**

#### **1. INNER JOIN**
Káº¿t há»£p cÃ¡c báº£ng vÃ  chá»‰ láº¥y cÃ¡c báº£n ghi khá»›p á»Ÿ cáº£ hai báº£ng.

```sql
SELECT e.name, e.position, d.name AS department
FROM employees e
INNER JOIN departments d
ON e.department_id = d.id;
```

#### **2. LEFT JOIN**
Láº¥y táº¥t cáº£ cÃ¡c báº£n ghi tá»« báº£ng bÃªn trÃ¡i, vÃ  báº£n ghi khá»›p tá»« báº£ng bÃªn pháº£i (náº¿u cÃ³).

```sql
SELECT e.name, e.position, d.name AS department
FROM employees e
LEFT JOIN departments d
ON e.department_id = d.id;
```

#### **3. RIGHT JOIN**
NgÆ°á»£c láº¡i vá»›i `LEFT JOIN`, láº¥y táº¥t cáº£ cÃ¡c báº£n ghi tá»« báº£ng bÃªn pháº£i.

```sql
SELECT e.name, e.position, d.name AS department
FROM employees e
RIGHT JOIN departments d
ON e.department_id = d.id;
```

---

### **VI. GROUP BY vÃ  HAVING**

#### **1. GROUP BY**
DÃ¹ng Ä‘á»ƒ nhÃ³m cÃ¡c báº£n ghi láº¡i vá»›i nhau dá»±a trÃªn má»™t hoáº·c nhiá»u cá»™t.

```sql
SELECT department_id, AVG(salary) AS avg_salary
FROM employees
GROUP BY department_id;
```

#### **2. HAVING**
DÃ¹ng Ä‘á»ƒ lá»c nhÃ³m sau khi Ä‘Ã£ thá»±c hiá»‡n `GROUP BY`.

```sql
SELECT department_id, AVG(salary) AS avg_salary
FROM employees
GROUP BY department_id
HAVING AVG(salary) > 55000;
```

---

### **VII. BÃ i Táº­p Thá»±c HÃ nh**

#### **BÃ i 1: Táº¡o vÃ  Thao TÃ¡c Dá»¯ Liá»‡u**

1. Táº¡o báº£ng `departments` vá»›i cáº¥u trÃºc:
   - `id` (INT, khÃ³a chÃ­nh).
   - `name` (VARCHAR, tÃªn phÃ²ng ban).
   
2. ThÃªm dá»¯ liá»‡u máº«u vÃ o báº£ng `departments`:
   ```sql
   INSERT INTO departments (id, name)
   VALUES 
   (1, 'IT'),
   (2, 'HR'),
   (3, 'Finance');
   ```

3. LiÃªn káº¿t báº£ng `employees` vá»›i `departments` vÃ  thá»±c hiá»‡n:
   - Láº¥y danh sÃ¡ch nhÃ¢n viÃªn cÃ¹ng phÃ²ng ban (`INNER JOIN`).
   - Láº¥y danh sÃ¡ch táº¥t cáº£ nhÃ¢n viÃªn, bao gá»“m cáº£ nhÃ¢n viÃªn khÃ´ng cÃ³ phÃ²ng ban (`LEFT JOIN`).

---

#### **BÃ i 2: Thá»‘ng KÃª vÃ  Tá»•ng Há»£p**

1. TÃ­nh lÆ°Æ¡ng trung bÃ¬nh cá»§a tá»«ng phÃ²ng ban.
   ```sql
   SELECT department_id, AVG(salary) AS avg_salary
   FROM employees
   GROUP BY department_id;
   ```

2. TÃ¬m cÃ¡c phÃ²ng ban cÃ³ má»©c lÆ°Æ¡ng trung bÃ¬nh cao hÆ¡n 60000.
   ```sql
   SELECT department_id, AVG(salary) AS avg_salary
   FROM employees
   GROUP BY department_id
   HAVING AVG(salary) > 60000;
   ```

---

#### **BÃ i 3: Tá»± Viáº¿t CÃ¢u Lá»‡nh SQL**

1. Táº¡o thÃªm má»™t báº£ng `projects` vá»›i cáº¥u trÃºc:
   - `id` (INT, khÃ³a chÃ­nh).
   - `name` (VARCHAR, tÃªn dá»± Ã¡n).
   - `budget` (DECIMAL).

2. LiÃªn káº¿t cÃ¡c báº£ng `employees`, `departments`, vÃ  `projects` Ä‘á»ƒ láº¥y:
   - Danh sÃ¡ch nhÃ¢n viÃªn, phÃ²ng ban cá»§a há», vÃ  dá»± Ã¡n mÃ  há» tham gia (giáº£ sá»­ má»—i nhÃ¢n viÃªn chá»‰ tham gia 1 dá»± Ã¡n).

---

ChÃºc báº¡n thá»±c hÃ nh tá»‘t! ğŸš€ 